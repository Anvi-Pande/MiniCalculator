#include <iostream>
#include <math.h>

using namespace std;

// Function prototypes
void display(char op, double num1, double num2, double result);
void primaryOp();
void specialOp();
double factorial(int n);
double square(double n);
double squareRoot(double n);
double sine(double n);
double cosine(double n);

double logarithm(double value, double base);
double naturalLog(double value);
void logOp();

// Main function
int main()
{

    bool loop = true;
    string inpt;

    cout << "~~~~~~Mini Calculator~~~~~~" << endl;

    while (loop)
    {
        cout << "Which operation would you like to compute.\n(1) Primary Operations\nAddition\nSubtraction\nMultiplication\nDivision\nPower\nRoot\nFactorial\n";
        cout << endl; 
        cout << "(2) Special Operations\nSine\nCosine\n";
        cout << "(3) Logarithim Operations\n";
        cin >> inpt;

        if (input == "1")
        {
            primaryOp();
        }
        
        if (inpt == "2")
        {
            specialOp();
        }
        if (input =="3")
            {
            logOp();
            }

        cout << "Input (STOP) to close (enter anything else to continue): ";
        cin >> inpt;
        if (inpt == "STOP")
        {
            loop = false;
        }
    }
}

// Display function for main function operations
void display(char op, double num1, double num2, double result)
{
    cout << "Equation: " << num1 << " " << op << " " << num2 << " = " << result << endl;
}

void primaryOp()
{
    double num1, num2;
    char op;
    double result;
    cout << "Enter a number: ";
    cin >> num1;
    cout << "Enter an operator (Addition (+), Subtraction (-), Multiplication (*), Division (/), Power (^), Root (r), Factorial (!)): ";
    cin >> op;
    cout << "Enter another number: ";
    cin >> num2;

    if (op == '+')
    {
        result = num1 + num2;
        display(op, num1, num2, result);
    }
    else if (op == '-')
    {
        result = num1 - num2;
        display(op, num1, num2, result);
    }
    else if (op == '*')
    {
        result = num1 * num2;
        display(op, num1, num2, result);
    }
    else if (op == '/')
    {
        if (num2 == 0)
        {
            cout << "Error: Division by zero!" << endl;
        }
        else
        {
            result = num1 / num2;
            display(op, num1, num2, result);
        }
    }
    else if (op == '^')
    {
        result = pow(num1, num2);
        display(op, num1, num2, result);
    }
    else if (op == 'r')
    {
        if (num2 == 0)
        {
            cout << "Error: Root degree cannot be zero!" << endl;
        }
        else
        {
            result = pow(num1, 1.0 / num2);
            display(op, num1, num2, result);
        }
    }
    else if (op == '!')
    {
        result = factorial((int)num1);
        if (result != -1)
            cout << num1 << "! = " << result << endl;
    }
    else
    {
        cout << "Error: Invalid operator!" << endl;
    }
}

void specialOp()
{
    char option;
    double angle;
    cout << "Enter 'S' for SINE and anything else for COSINE " << endl;
    cin >> option;

    if (option == 'S' || option == 's' ) 
    {
        cout << "SINE\nEnter the angle you want in degrees(ex: for sin(90 degrees), enter 90): " << endl;
        cin >> angle;
        cout << endl << "SIN(" << angle << ") = " << sine(angle) << endl;
    }
    else 
    {
        cout << "COSINE\nEnter the angle you want in degrees(ex: for cos(90 degrees), enter 90): " << endl;
        cin >> angle;
        cout << endl << "COS(" << angle << ") = " << cosine(angle) << endl;
    }

}

// Square function definition
double square(double n)
{
    return n * n;
}

// Square root function definition
double squareRoot(double n)
{
    if (n < 0)
    {
        cout << "Error: Cannot take square root of negative number!" << endl;
        return -1;
    }
    return sqrt(n);
}

// Factorial function definition
double factorial(int n)
{
    if (n < 0)
    {
        cout << "Error: Factorial of negative number is undefined!" << endl;
        return -1;
    }
    double fact = 1;
    for (int i = 1; i <= n; i++)
    {
        fact *= i;
    }
    return fact;
}

// Sine function definition
double sine(double n)
{
    double answer;
    double first, second, third, fourth, fifth, sixth, seventh, eighth, ninth, tenth;
    double radians;
    const double PI = 3.14159265359; 

    radians = n * (PI / 180);
    first = radians;
    second = (pow(radians,3)) / (factorial(3));
    third = (pow(radians,5)) / (factorial(5));
    fourth = (pow(radians,7)) / (factorial(7));
    fifth = (pow(radians,9)) / (factorial(9));
    sixth = (pow(radians,11)) / (factorial(11));
    seventh = (pow(radians,13)) / (factorial(13));
    eighth = (pow(radians,15)) / (factorial(15));
    ninth = (pow(radians,17)) / (factorial(17));
    tenth = (pow(radians,19)) / (factorial(19));
    answer = first - second + third - fourth + fifth - sixth + seventh - eighth + ninth - tenth;

    return answer;
}

// Cosine function definition
double cosine(double n)
{
    double answer;
    double first, second, third, fourth, fifth, sixth, seventh, eighth, ninth;
    double radians;
    const double PI = 3.14159265359; 

    radians = n * (PI / 180);
    first = (pow(radians,2)) / (factorial(2));
    second = (pow(radians,4)) / (factorial(4));
    third = (pow(radians,6)) / (factorial(6));
    fourth = (pow(radians,8)) / (factorial(8));
    fifth = (pow(radians,10)) / (factorial(10));
    sixth = (pow(radians,12)) / (factorial(12));
    seventh = (pow(radians,14)) / (factorial(14));
    eighth = (pow(radians,16)) / (factorial(16));
    ninth = (pow(radians,18)) / (factorial(18));
    answer = 1 - first + second - third + fourth - fifth + sixth - seventh + eighth - ninth;

    return answer;
}
// logarithim function 
double logarithm(double value, double base)
{
    if (value <= 0)
    {
        cout << "Error: Logarithm undefined for non-positive values!" << endl;
        return NAN;
    }
    if (base <= 0 || base == 1)
    {
        cout << "Error: Base must be positive and not equal to 1!" << endl;
        return NAN;
    }
    return log(value) / log(base);
}

// Natural log
double naturalLog(double value)
{
    if (value <= 0)
    {
        cout << "Error: Natural log undefined for non-positive values!" << endl;
        return NAN;
    }
    return log(value);
}

//  logarithm operation
void logOp()
{
    double value, base;
    cout << "LOGARITHM OPERATION" << endl;
    cout << "Enter the value (>0): ";
    cin >> value;
    cout << "Enter the base (enter 0 for natural log): ";
    cin >> base;

    if (base == 0)
    {
        cout << "ln(" << value << ") = " << naturalLog(value) << endl;
    }
    else
    {
        cout << "log base " << base << " of " << value << " = " << logarithm(value, base) << endl;
    }
}
